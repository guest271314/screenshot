// screenshot.js guest271314 10-31-2020 https://github.com/guest271314/screenshot
// getDisplayMedia() => MediaRecorder() => VP8 - WebM JavaScript Decoder => ImageData
async function screenshot(){'use strict';function e(e,_){return e==_?0:e>_?1:-1}function _(e,_,t,o){if(e.val=new Dt,o.data.length<t+o.data_off)return o.data_off+=t,0;for(var r=0;r<t;++r)e.val[r]=o.data[o.data_off++];return e.val.length=t,r}function t(e){return e.data_off}function o(e){return e.data.length<e.data_off?1:0}function r(e){return"undefined"==typeof e?"error":JSON.parse(JSON.stringify(e))}function f(e,_,t,o,r){var a;for(a=0;a<r;++a)e[_+a]=t[o+a];return e}function s(e,_,t,o){var r=0;for(r=0;r<o;++r)e[_+r]=t}function d(e,_){var t,o=[];for(t=0;t<e;++t)o.push(_);return o}function n(e){if(!e)throw new Error("assert :P")}function m(){return 0}function l(e,_){var t,o=[];for(t=0;t<e;++t)o.push(_);return o}function p(e,_){var t,o=[];for(t=0;t<e;++t)o.push(new _);return o}function b(e,_){var t;for(t=e.length-1;0<=t;--t)_=r(l(e[t],_));return _}function c(e,_){var t=e,o=0;for(var r in t)t[r]="object"==typeof t[r]&&Object.keys(t[r]).length==_[o].length?c(t[r],_[o]):_[o],o++;return t}function v(e,_,t,o,r){return[e,_,t,r,0,null,0,0]}function h(e,_,t,o,r,a){return[e,_,t,r,1,a,1,0]}function y(e,_,t,o,r,a){return[e,_,t,r,0,a,0,0]}function g(e,_,t){return[e,_,t,0,2,null,0,0]}function u(e){for(var _=[],t=0;t<e.length;++t){var o=0,r=new uo;for(var f in r)"undefined"!==e[t][o]&&(r[f]=e[t][o++]);_.push(r)}return _}function x(){var e=new co;return e}function k(e,_){for(var t=0,o={val:No},a=1;0<_&&(t=_<o.val.length?_:o.val.length,a=w(e,o,t),1==a);)_-=t;return a}function I(e){return e.tell(e.userdata)}function D(e,_,t,o){var a=0,f={val:0},s=1,d=128;if(a=w(e,f,1),1!=a)return a;for(;s<8&&0==(f.val[0]&d);)d>>=1,s+=1;for(t&&(t.val=s),_.val=f.val[0],1==o&&(_.val=f.val[0]&~d);--s;){if(a=w(e,f,1),1!=a)return a;_.val<<=8,_.val|=f.val[0]}return 1}function w(e,_,t){var o=e.read(_,t,e.userdata);return o}function E(e,_,t){return D(e,_,t,0)}function q(e,_,t){return D(e,_,t,1)}function C(e,_,t){var o=0,a=[0],f=[0],o=D(e,a,f,1);return 1==o?(_[0]=a-[63,8191,1048575,134217727,17179869183,2199023255551,0xffffffffffff,0x7fffffffffffff][f-1],t&&(t[0]=f),o):o}function T(e,_,t){var o={val:0},a=0;if(0==t||8<t)return-1;if(a=w(e,o,1),1!=a)return a;for(_[0]=o.val[0];--t;){if(a=w(e,o,1),1!=a)return a;_[0]<<=8,_[0]|=o.val[0]}return 1}function O(e,_,t){var o=0,a=[0],f=0;return(o=T(e,a,t),1!=o)?o:(8>t?(f=1,f<<=8*t-1,a>=f?(f=1,f<<=8*t):f=0,_[0]=a-f):_[0]=a,1)}function L(e,_,t){var o={u:[0],f:[0],d:[0]},a=0;return 4!=t&&8!=t?-1:(a=T(e,o.u,t),1!=a)?a:(_[0]=4==t?o.f=o.u:o.d=o.u,1)}function z(e,_,t){var o={val:0},a=0;if(0==t||1048576<t)return-1;if(a=w(e.io,o,t),1!=a)return a;for(var f="",s=0;s<t;++s)f+=String.fromCharCode(o.val[s]);return o.val=f,_[0]=o.val,1}function R(e,_,t){return 0==t||16777216<t?-1:(_.data={val:0},_.length=t,w(e.io,_.data,t))}function A(e,_){return e.read?(n(2==e.type),_[0]=e.v.u,0):-1}function P(e,_){return e.read?(n(5==e.type),_[0]=e.v.s,0):-1}function S(e,_){for(;_;_=_.previous)for(var t=_.node,o=0;t[o].id;++o)if(t[o].id==e)return 1;return 0}function N(e,_){for(var t=_,o=0;t[o].id;++o)if(t[o].id==e)return t[o];return null}function j(e,_,t){var o=new vo;o.previous=e.ancestor,o.node=_,o.data=t,e.ancestor=o}function B(e){var _;_=e.ancestor,e.ancestor=_.previous,_=""}function U(e,_,t){var o=0;return e.last_id&&e.last_size?(_&&(_[0]=e.last_id),t&&(t[0]=e.last_size),1):(e.last_id={val:e.last_id},o=E(e.io,e.last_id,null),e.last_id=e.last_id.val,1!=o)?o:(e.last_size={val:e.last_size},o=q(e.io,e.last_size,null),e.last_size=e.last_size.val,1!=o)?o:(_&&(_[0]=e.last_id),t&&(t[0]=e.last_size),1)}function K(e,_,t){var o=0;return(o=U(e,_,t),1!=o)?o:(e.last_id=0,e.last_size=0,1)}function M(e,_){var t,o,r=new Zt;n(1==_.type&&1&_.flags),!e.ancestor.data[_.offset]||(t=e.ancestor.data[_.offset]),r.id=_.id,r.data=new window[_.offset],o=t.tail,o&&(o.next=r),t.tail=r,t.head||(t.head=r),j(e,_.children,r.data)}function G(e,_){n(1==_.type&&!(1&_.flags)),j(e,_.children,e.ancestor.data[_.offset])}function F(e,_,t){var o,a=0;if(!e.ancestor.data[_.offset]||(o=e.ancestor.data[_.offset]),o.read)return 0;switch(o.type=_.type,a=-1,_.type){case 2:o.v.u=[o.v.u],a=T(e.io,o.v.u,t),o.v.u=o.v.u[0];break;case 3:o.v.f=[o.v.f],a=L(e.io,o.v.f,t),o.v.f=o.v.f[0];break;case 4:o.v.i=[o.v.i],a=O(e.io,o.v.i,t),o.v.i=o.v.i[0];break;case 5:o.v.s=[o.v.s],a=z(e,o.v.s,t),o.v.s=o.v.s[0];break;case 6:a=R(e,o.v.b,t);break;case 1:case 0:n(0);}return 1==a&&(o.read=1),a}function H(e,_){var t,o=0,a=0,f=[0],s=[0];if(!e.ancestor)return-1;for(;o=U(e,f,s),1==o;)if(t=N(f[0],e.ancestor.node),t){if(2&t.flags){n(6==t.type),o=1;break}if(o=K(e,f,s),1!=o)break;if(4&t.flags&&(a=e.ancestor.data[t.data_offset]={v:null},a.v=I(e.io),0>a)){o=-1;break}if(1==t.type){1&t.flags?M(e,t):G(e,t);continue}else if(o=F(e,t,s[0]),0>o)break}else if(S(f,e.ancestor.previous)){if(_&&e.ancestor.node==_){o=1;break}B(e)}else{if(o=K(e,f,s),1!=o)break;if(o=k(e.io,s[0]),1!=o)break}if(1!=o)for(;e.ancestor;)B(e);return o}function V(e,_,t,o){var a=0,f=[0];if(a=T(e,f,1),1!=a)return a;for(o[0]+=1,_[t+0]=f[0];255==f[0];){if(a=T(e,f,1),1!=a)return a;o[0]+=1,_[t+0]+=f[0]}return 1}function Y(e,_,t,o,a){for(var f=0,s=0,d=0;--o;){if(f=V(e,a,s,t),1!=f)return f;d+=a[s],s+=1}return t[0]+d>_?-1:(a[s]=_-t[0]-d,1)}function W(e,_,t,o,a){var f=0,s=[0],d=0,m=[0],l=[0],p=0;if(f=q(e,s,m),1!=f)return f;for(t[0]+=m[0],a[p]=s[0],d=a[p],p+=1,o-=1;--o;){if(f=C(e,l,m),1!=f)return f;t[0]+=m[0],a[p]=a[p-1]+l[0],d+=a[p],p+=1}return t[0]+d>_?-1:(a[p]=_-t[0]-d,1)}function Q(e){var _=[0];return 0!=A(e.segment.info.timecode_scale,_)&&(_[0]=1e6),_[0]}function Z(e,_){for(var t=0,o=e.segment.tracks.track_entry.head;o;){if(n(174==o.id),_==t)return o.data;t+=1,o=o.next}return null}function J(e,_,t,o){var a,s,d,m,l,p=0,b=[0],c=0,v=0,h={val:0},y={val:0},g=jo,u=[0],x=[0],k=[0],I=0,D=0,E=0,C=0,L=[0];if(o[0]=null,1073741824<t)return-1;if(p=q(e.io,h,y),1!=p)return p;if(0==h.val||h.val>e.track_count)return-1;if(L[0]+=y.val,p=O(e.io,b,2),1!=p)return p;if(L[0]+=2,p=T(e.io,x,1),1!=p)return p;switch(L[0]+=1,k[0]=0,C=(6&x[0])>>1,C){case 0:k[0]=1;break;case 1:case 2:case 3:if(p=T(e.io,k,1),1!=p)return p;L[0]+=1,k[0]+=1;}if(256<k[0])return-1;switch(C){case 0:g[0]=t-L[0];break;case 1:if(1==k)return-1;if(p=Y(e.io,t,L,k,g),1!=p)return p;break;case 2:if((t-L[0])%k[0])return-1;for(E=0;E<k[0];++E)g[E]=(t-L[0])/k>>0;break;case 3:if(1==k[0])return-1;if(p=W(e.io,t,L,k,g),1!=p)return p;}for(D=L[0],E=0;E<k[0];++E)D+=g[E];if(D>t)return-1;if(l=Z(e,h.val-1),!l)return-1;if(v=1,I=Q(e),n(524531317==e.segment.cluster.tail.id),s=e.segment.cluster.tail.data,0!=A(s.timecode,u))return-1;if(c=b[0]+u[0],0>c)return-1;for(a=new go,a.track=h.val-1,a.timecode=c*I*v,m=null,E=0;E<k[0];++E){if(268435456<g[E])return se(a),-1;if(d=new ho,d.data=[],d.length=g[E],d.data={val:d.data},p=w(e.io,d.data,g[E]),d.data=d.data.val,1!=p)return d.data=null,d=null,se(a),-1;m?m.next=d:a.frame=d,m=d}return o[0]=a,1}function $(e){return 163==e||161==e?1:0}function ee(_,t){var o,a=0,f=[0],s=[0],d=[0],i=[0],n=Bo;if(!(t.read&&t.seek&&t.tell))return-1;if(n.io=t,n.alloc_pool=x(),a=U(n,f,null),1!=a)return _e(n),-1;if(440786851!=f[0])return _e(n),-1;if(j(n,So,n),a=H(n,null),1!=a)return _e(n),-1;if(0!=A(n.ebml.ebml_read_version,s)&&(s=1),1!=s[0])return _e(n),-1;if(0!=P(n.ebml.doctype,i)&&(i[0]="matroska"),0!=e(i[0],"webm"))return _e(n),-1;if(0!=A(n.ebml.doctype_read_version,d)&&(d[0]=1),1>d[0]||2<d[0])return _e(n),-1;if(!n.segment.tracks.track_entry.head)return _e(n),-1;for(o=n.segment.tracks.track_entry.head,n.track_count=0;o;)n.track_count+=1,o=o.next;return _[0]=n,0}function _e(){}function te(e,_){return _[0]=e.track_count,0}function oe(e,_){var t=[0],o=Z(e,_);return o?0==A(o.type,t)?1&t[0]?0:2&t[0]?1:-1:-1:-1}function re(_,t){var o=[0],r=Z(_,t);return r?0==P(r.codec_id,o)?0==e(o[0],"V_VP8")?0:0==e(o[0],"A_VORBIS")?1:-1:-1:-1}function ae(e,_,t){var o=[0],r=Z(e,_);return r?0==oe(e,_)?0==A(r.video.pixel_width,o)?(t.width=o[0],0!=A(r.video.pixel_height,o))?-1:(t.height=o[0],o[0]=0,A(r.video.pixel_crop_bottom,o),t.crop_bottom=o[0],o[0]=0,A(r.video.pixel_crop_top,o),t.crop_top=o[0],o[0]=0,A(r.video.pixel_crop_left,o),t.crop_left=o[0],o[0]=0,A(r.video.pixel_crop_right,o),t.crop_right=o[0],o[0]=t.width,A(r.video.display_width,o),t.display_width=o[0],o[0]=t.height,A(r.video.display_height,o),t.display_height=o[0],0):-1:-1:-1}function fe(e,_){var t=0,o=[0],a=[0];for(_[0]=null;;){if(t=U(e,o,a),1!=t)return t;if($(o))return(t=K(e,o,a),1!=t)?t:(t=J(e,o,a[0],_),t);if(t=H(e,null),1!=t)return t}return 1}function se(e){for(var _;e.frame;)_=e.frame,e.frame=_.next,_.data="",_="";e=""}function de(e,_){return _[0]=e[0].track,0}function ie(e,_){var t=e[0].frame;for(_[0]=0;t;)_[0]+=1,t=t.next;return 0}function ne(e,_,t,o){var r=e[0].frame,a=0;for(t[0]=null,o[0]=0;r;){if(a==_)return t[0]=r.data,o[0]=r.length,0;a+=1,r=r.next}return-1}function me(e,_,t,o,r,a){var f=0,i=0,n=0,m=0,l=0,p=0,b=0;switch(r||(r=1),r&r-1&&alert("goto fail"),_){case 2:case 9:case 10:case 11:p=32;break;case 1:case 8:p=24;break;case 3:case 12:case 4:case 13:case 5:case 6:case 7:p=16;break;case Mo:case 769:case Go:case 771:p=12;break;default:p=16;}return m=_===Mo||769===_||_===Go||771===_?1:0,l=_===Mo||769===_||_===Go||771===_?1:0,(b=(1<<m)-1,i=t+b&~b,b=(1<<l)-1,f=o+b&~b,n=256&_?i:p*i/8,n=n+r-1&~(r-1),e||(e=new Mt,!e&&alert("goto fail"),e.self_allocd=1),e.img_data=a,a||(e.img_data=d(256&_?f*i*p/8:f*n,0),e.img_data_owner=1),e.img_data||alert("goto fail"),e.fmt=e.fmt=_,e.w=e.w=i,e.h=e.h=f,e.x_chroma_shift=e.x_chroma_shift=m,e.y_chroma_shift=e.y_chroma_shift=l,e.bps=e.bps=p,e.stride[0]=e.stride[3]=n,e.stride[1]=e.stride[2]=n>>m,!pe(e,0,0,t,o))?e:(be(e),null)}function le(e,_,t,o,r){return me(e,_,t,o,r,null)}function pe(e,_,t,o,r){var a=0,f=0;return _+o<=e.w&&t+r<=e.h?(e.d_w=e.d_w=o,e.d_h=e.d_h=r,256&e.fmt?(a=e.img_data,f=e.img_data_off,1024&e.fmt&&(e.planes[3]=a,e.planes_off[3]=f+_+t*e.stride[3],f+=e.h*e.stride[3]),e.planes[0]=a,e.planes_off[0]=f+_+t*e.stride[0],f+=e.h*e.stride[0],512&e.fmt?(e.planes[2]=a,e.planes_off[2]=f+(_>>e.x_chroma_shift)+(t>>e.y_chroma_shift)*e.stride[2],f+=(e.h>>e.y_chroma_shift)*e.stride[2],e.planes[1]=a,e.planes_off[1]=f+(_>>e.x_chroma_shift)+(t>>e.y_chroma_shift)*e.stride[1]):(e.planes[1]=a,e.planes_off[1]=f+(_>>e.x_chroma_shift)+(t>>e.y_chroma_shift)*e.stride[1],f+=(e.h>>e.y_chroma_shift)*e.stride[1],e.planes[2]=a,e.planes_off[2]=f+(_>>e.x_chroma_shift)+(t>>e.y_chroma_shift)*e.stride[2])):(e.planes[0]=e.img_data,e.img_data_of+parseInt(_*e.bps/8+t*e.stride[0],10)),0):-1}function be(e){e&&(e.img_data&&e.img_data_owner&&(e.img_data=""),e.self_allocd&&(e=""))}function ce(e,_,t,o){2<=o?(e.value=_[t+0]<<8|_[t+1],e.input=_,e.input_off=t+2,e.input_len=o-2):(e.value=0,e.input=null,e.input_len=0),e.range=255,e.bit_count=0}function ve(e,_){var t=1+((e.range-1)*_>>8),o=t<<8,r=0;for(e.value>=o?(r=1,e.range-=t,e.value-=o):(r=0,e.range=t);128>e.range;)e.value<<=1,e.range<<=1,8==++e.bit_count&&(e.bit_count=0,e.input_len&&(e.value|=e.input[e.input_off++],e.input_len--));return r}function he(e){return ve(e,128)}function ye(e,_){var t=0,o=0;for(o=_-1;0<=o;o--)t|=he(e)<<o;return t}function ge(e,_){var t=0,o=0;for(o=_-1;0<=o;o--)t|=he(e)<<o;return he(e)?-t:t}function ue(e,_){return he(e)?ge(e,_):0}function xe(e,_,t,o){var r=0;if("undefined"!=typeof o)for(;0<(r=_[r+ve(e,t[o+(r>>1)])]););else for(;0<(r=_[r+ve(e,t[r>>1])]););return-r}function ke(e){return(1<<e)-1}function Ie(e,_,t){return e>>_&ke(t)}function De(e){return 0>e?0:255<e?255:e}function we(e,_,t,o){var r=0,a=0,f=0,s=0,d=0,n=0,m=0,l=0,p=0,b=e,c=_,v=t,h=o;for(r=0;4>r;r++)a=b[c+0]+b[c+12],f=b[c+4]+b[c+8],s=b[c+4]-b[c+8],d=b[c+0]-b[c+12],v[h+0]=a+f,v[h+4]=s+d,v[h+8]=a-f,v[h+12]=d-s,c++,h++;for(b=t,c=o,v=t,h=o,r=0;4>r;r++)a=b[c+0]+b[c+3],f=b[c+1]+b[c+2],s=b[c+1]-b[c+2],d=b[c+0]-b[c+3],n=a+f,m=s+d,l=a-f,p=d-s,v[h+0]=n+3>>3,v[h+1]=m+3>>3,v[h+2]=l+3>>3,v[h+3]=p+3>>3,c+=4,h+=4}function Ee(e,_,t,o){var r=0,a=0,f=0,s=0,d=0,n=e,m=_,l=t,p=o,b=0,c=0,v=4;for(r=0;4>r;r++)a=n[m+0]+n[m+8],f=n[m+0]-n[m+8],b=35468*n[m+4]>>16,c=n[m+12]+(20091*n[m+12]>>16),s=b-c,b=n[m+4]+(20091*n[m+4]>>16),c=35468*n[m+12]>>16,d=b+c,l[p+0*v]=a+d,l[p+3*v]=a-d,l[p+1*v]=f+s,l[p+2*v]=f-s,m++,p++}function qe(e,_,t,o,r,a,f){var s=0,d=0,n=0,m=0,l=0,p=0,b=0,c=0;for(Ee(a,f,cr,c),a=cr,f=c,s=0;4>s;s++)d=a[f+0]+a[f+2],n=a[f+0]-a[f+2],p=35468*a[f+1]>>16,b=a[f+3]+(20091*a[f+3]>>16),m=p-b,p=a[f+1]+(20091*a[f+1]>>16),b=35468*a[f+3]>>16,l=p+b,e[_+0]=t[o+0]+(d+l+4>>3),e[_+3]=t[o+3]+(d-l+4>>3),e[_+1]=t[o+1]+(n+m+4>>3),e[_+2]=t[o+2]+(n-m+4>>3),f+=4,_+=r,o+=r}function Ce(e,_){var t=new sr;return t.d.x=e.d.x<_.to_left?_.to_left:e.d.x,t.d.x=e.d.x>_.to_right?_.to_right:t.d.x,t.d.y=e.d.y<_.to_top?_.to_top:e.d.y,t.d.y=e.d.y>_.to_bottom?_.to_bottom:t.d.y,t}function Te(e,_){return ve(e,_.tree_probs[0])?2+ve(e,_.tree_probs[2]):ve(e,_.tree_probs[1])}function Oe(e,_,t){if(4>t)switch(_.base.y_mode){case 0:return 0;case 1:return 2;case 2:return 3;case 3:return 1;case 4:return _.splitt.mvs[t+12].d.x;default:n(0);}return e.splitt.mvs[t-4].d.x}function Le(e,_,t){if(!(3&t))switch(_.base.y_mode){case 0:return 0;case 1:return 2;case 2:return 3;case 3:return 1;case 4:return _.splitt.mvs[t+3].d.x;default:n(0);}return e.splitt.mvs[t-1].d.x}function ze(e,_,t,o,r,f,s){var d=0,n=0;if(d=xe(s,qr,Dr),4==d){var m=0;for(m=0;16>m;m++){var p=Oe(e[_],r[f],m),a=Le(e[_],t[o],m),l=0;l=xe(s,Or,Er[p][a]),e[_].splitt.modes[m]=e[_].splitt.mvs[m].d.x=l,e[_].splitt.mvs[m].d.y=0}}n=xe(s,Tr,wr),e[_].base.y_mode=d,e[_].base.uv_mode=n,e[_].base.mv.d.x=e[_].base.mv.d.y=0,e[_].base.ref_frame=0}function Re(e,_,t){var o=0,r=0;if(o=xe(t,Cr,_.y_mode_probs),4==o){var a=0;for(a=0;16>a;a++){var f;f=xe(t,Or,Pr),e.splitt.modes[a]=e.splitt.mvs[a].d.x=f,e.splitt.mvs[a].d.y=0}}r=xe(t,Tr,_.uv_mode_probs),e.base.y_mode=o,e.base.uv_mode=r,e.base.mv.d.x=e.base.mv.d.y=0,e.base.ref_frame=0}function Ae(e,_){var t=0;if(ve(e,_[0])){var o=0;for(o=0;3>o;o++)t+=ve(e,_[9+o])<<o;for(o=9;3<o;o--)t+=ve(e,_[9+o])<<o;(!(65520&t)||ve(e,_[12]))&&(t+=8)}else t=xe(e,Lr,_,2);return t&&ve(e,_[1])&&(t=-t),t<<1}function Pe(e,_,t){return 4>t?9==_.base.y_mode?_.splitt.mvs[t+12]:_.base.mv:e.splitt.mvs[t-4]}function Se(e,_,t){return 3&t?e.splitt.mvs[t-1]:9==_.base.y_mode?_.splitt.mvs[t+3]:_.base.mv}function Ne(e,_,t){var o=!(_.d.x||_.d.y)+0,r=!(t.d.x||t.d.y)+0,a=(_.d.x==t.d.x&&_.d.y==t.d.y)+0,f=0;return a&&o?f=4:a?f=3:r?f=2:o&&(f=1),xe(e,Rr,jr[f])}function je(e,_,t){_.d.y=Ae(e,t[0]),_.d.x=Ae(e,t[1])}function Be(e,_,t,o){_[e.base.ref_frame]^_[t]&&(o.d.x*=-1,o.d.y*=-1)}function Ue(e,_,t,o,r,a,f,s){var d=f,i=0,n=s,m=0;d[0].d.x=d[1].d.x=d[2].d.x=0,d[0].d.y=d[1].d.y=d[2].d.y=0,s[0]=s[1]=s[2]=s[3]=0;var l=o[r],p=_[t],b=o[r-1];if(0!=l.base.ref_frame&&((l.base.mv.d.x||l.base.mv.d.y)&&(d[++i].d.x=l.base.mv.d.x,d[i].d.y=l.base.mv.d.y,Be(l,a,e.base.ref_frame,d[i]),++m),n[m]+=2),0!=p.base.ref_frame)if(p.base.mv.d.x||p.base.mv.d.y){var c=Ur;c.d.x=p.base.mv.d.x,c.d.y=p.base.mv.d.y,Be(p,a,e.base.ref_frame,c),(c.d.x!=d[i].d.x||c.d.y!=d[i].d.y)&&(d[++i].d.x=c.d.x,d[i].d.y=c.d.y,++m),n[m]+=2}else s[0]+=2;if(0!=b.base.ref_frame)if(b.base.mv.d.x||b.base.mv.d.y){var c=Kr;c.d.x=b.base.mv.d.x,c.d.y=b.base.mv.d.y,Be(b,a,e.base.ref_frame,c),(c.d.x!=d[i].d.x||c.d.y!=d[i].d.y)&&(d[++i].d.x=c.d.x,d[i].d.y=c.d.y,++m),n[m]+=1}else s[0]+=1;if(s[3]&&d[i].d.x==f[1].d.x&&d[i].d.y==f[1].d.y&&(s[1]+=1),s[3]=2*((9==l.base.y_mode)+(9==p.base.y_mode))+(9==b.base.y_mode),s[2]>s[1]){var v=0,h=0;v=s[1],s[1]=s[2],s[2]=v,v=f[1].d.x,h=f[1].d.y,f[1].d.x=f[2].d.x,f[1].d.y=f[2].d.y,f[2].d.x=v,f[2].d.y=h}s[1]>=s[0]&&(f[0].d.x=f[1].d.x,f[0].d.y=f[1].d.y)}function Ke(e,_,t,o,r,a){var f=0,s=0,d=0,i=0,m=0;for(m=xe(a,Ar,Nr),f=Br[m],e.base.partitioning=m,(s=0,i=0);65535>i;s++){var l,p,b,c=new sr;for(d=0;s!=f[d];d++);for(l=Se(e,_,d),p=Pe(e,t,d),b=Ne(a,l,p),10===b?c=l:11===b?c=p:12===b?c.d.x=c.d.y=0:13===b?(je(a,c,o.mv_probs),c.d.x+=r.d.x,c.d.y+=r.d.y):n(0);16>d;d++)s==f[d]&&(e.splitt.mvs[d].d.x=c.d.x,e.splitt.mvs[d].d.y=c.d.y,i|=1<<d)}}function Me(e,_,o,a,f,s){var d=0,i=0;return _+=e.d.x>>3,o+=e.d.y>>3,i=f-(_+a),d=s-(o+a),2>_>>1||3>i>>1||2>o>>1||3>d>>1}function Ge(e,_,t,o,r,a,f,s,d){var i=e.entropy_hdr,m=Mr,l=Vr,p=Gr,c=Fr,v=0,g=0,u=0,k=0,I=0,D=0;switch(_[t].base.ref_frame=ve(d,i.prob_last)?2+ve(d,i.prob_gf):1,Ue(_[t],_,t-1,a,f,e.reference_hdr.sign_bias,m,p),c[0]=Sr[p[0]][0],c[1]=Sr[p[1]][1],c[2]=Sr[p[2]][2],c[3]=Sr[p[3]][3],_=_[t],_.base.y_mode=xe(d,zr,c),_.base.uv_mode=_.base.y_mode,_.base.need_mc_border=0,g=-s.to_left-128>>3,u=-s.to_top-128>>3,k=16*e.mb_cols,I=16*e.mb_rows,_.base.y_mode){case 5:_.base.mv=Ce(m[1],s);break;case 6:_.base.mv=Ce(m[2],s);break;case 7:return void(_.base.mv.d.x=_.base.mv.d.y=0);case 8:l=Ce(m[v],s),je(d,_.base.mv,i.mv_probs),_.base.mv.d.x+=l.d.x,_.base.mv.d.y+=l.d.y;break;case 9:{var E=Hr;for(l=Ce(m[v],s),Ke(_,o[r],a[f],i,l,d),_.base.mv.d.x=_.splitt.mvs[15].d.x,_.base.mv.d.y=_.splitt.mvs[15].d.y,D=0;16>D;D++)if(E[(1&D>>1)+(2&D>>2)].d.x+=_.splitt.mvs[D].d.x,E[(1&D>>1)+(2&D>>2)].d.y+=_.splitt.mvs[D].d.y,Me(_.splitt.mvs[D],g+4*(3&D),u+(-4&D),4,k,I)){_.base.need_mc_border=1;break}for(D=0;4>D;D++)if(E[D].d.x+=4,E[D].d.y+=4,E[D].d.x>>=2,E[D].d.y>>=2,Me(E[D],g+8*(1&D),u+8*(D>>1),16,k,I)){_.base.need_mc_border=1;break}return}default:n(0);}Me(_.base.mv,g,u,16,k,I)&&(_.base.need_mc_border=1)}function Fe(e,_,t,o,r){var a,f,s=0,d=0,i=0,n=Xr;for(f=e.mb_info_rows[1+t],d=e.mb_info_rows_off[1+t]+o,a=e.mb_info_rows[1+t-1],s=e.mb_info_rows_off[1+t-1]+o,n.to_left=-(o+1<<7),n.to_right=e.mb_cols-o<<7,n.to_top=-(t+1<<7),n.to_bottom=e.mb_rows-t<<7,i=o;i<o+r;i++)e.segment_hdr.update_map&&(f[d].base.segment_id=Te(_,e.segment_hdr)),e.entropy_hdr.coeff_skip_enabled&&(f[d].base.skip_coeff=ve(_,e.entropy_hdr.coeff_skip_prob)),e.frame_hdr.is_keyframe?(!e.segment_hdr.update_map&&(f[d].base.segment_id=0),ze(f,d,f,d-1,a,s,_)):(ve(_,e.entropy_hdr.prob_inter)?Ge(e,f,d,f,d-1,a,s,n,_):Re(f[d],e.entropy_hdr,_),n.to_left-=128,n.to_right-=128),d++,s++}function He(e){var _=0,t=0,o=0,r=new ir,a=0;for(_=e.mb_cols+1,t=e.mb_rows+1,e.frame_hdr.frame_size_updated&&(e.mb_info_storage=null,e.mb_info_rows_storage=null),e.mb_info_storage||(e.mb_info_storage=p(_*t,e.mb_info_storage_object),e.mb_info_storage_off=0),e.mb_info_rows_storage||(e.mb_info_rows_storage=p(t,e.mb_info_rows_storage_object),e.mb_info_rows_storage_off=Array(t)),r=e.mb_info_storage,a=e.mb_info_storage_off+1,o=0;o<t;o++)e.mb_info_rows_storage[o]=r,e.mb_info_rows_storage_off[o]=a,a+=_;e.mb_info_rows=e.mb_info_rows_storage,e.mb_info_rows_off=e.mb_info_rows_storage_off}function Ve(e){return 11*(3*e)}function a(e,_,o,r,a,f,s,d){function n(_){k=(he(e)?-_:_)*z[!!u+0]}function m(_,t){if(!ve(e,_))return R=t,1}function l(_,t){if(!ve(e,_))return L=T,15>u?(++u,L+=Qr[u],R=t,1):(R=12,1)}function p(e){return(n(e),L=T+22,15>u)?(E[q+Jr[u]]=k,++u,R=1,1):(E[q+Jr[15]]=k,R=12,1)}function b(_,t){I+=ve(e,Zr[_].probs[t])<<t}var h=0,y=0,g=0,u=0,x=0,k=0,I=0,D=0,w=0,E=0,q=0,C=0,T=0,O=0,L=0,z=0;w=0,4!=f&&9!=f?(h=24,y=24,g=1,E=r,q=a+384,z=d[2]):(h=0,y=16,g=3,E=r,q=a,z=d[0]),C=s,T=11*(3*(8*g));var R=0;do{if(0==R&&(x=_[Yr[h]]+o[Wr[h]],u=!g+0,O=C,L=T,L+=11*x,R=1),1==R){if(L+=Qr[u],m(O[L+0],12))continue;R=2}if(2==R){if(l(O[L+1],2))continue;if(m(O[L+2],11))continue;if(m(O[L+3],8))continue;if(m(O[L+6],6))continue;if(m(O[L+8],4))continue;if(m(O[L+10],3))continue;I=Zr[10].min_val,D=Zr[10].length;do b(10,D),D--;while(0<=D);if(p(I))continue}if(3==R&&(I=Zr[9].min_val,b(9,4),b(9,3),b(9,2),b(9,1),b(9,0),p(I)))continue;if(4==R){if(m(O[L+9],5))continue;if(I=Zr[8].min_val,b(8,3),b(8,2),b(8,1),b(8,0),p(I))continue}if(5==R&&(I=Zr[7].min_val,b(7,2),b(7,1),b(7,0),p(I)))continue;if(6==R){if(m(O[L+7],7))continue;if(I=Zr[6].min_val,b(6,1),b(6,0),p(I))continue}if(7==R&&(I=Zr[5].min_val,b(5,0),p(I)))continue;if(8==R){if(m(O[L+4],10))continue;if(m(O[L+5],9))continue;if(p(4))continue}if(9==R&&p(3))continue;if(10==R&&p(2))continue;if(11==R){if(n(1),L=T+11,15>u){E[q+Jr[u]]=k,++u,R=1;continue}E[q+Jr[15]]=k,R=12}if(12==R){if(w=(w|(1<u)+0<<h)>>>0,x=(u!=!g)+0,w=(w|x<<31)>>>0,_[Yr[h]]=o[Wr[h]]=x,q+=16,h++,h<y){R=0;continue}if(25==h){g=0,h=0,y=16,T=11*(3*(8*g)),q=a,z=d[0],R=0;continue}if(16==h){g=2,T=11*(3*(8*g)),y=24,z=d[1],R=0;continue}}R=13}while(13!=R);return w}function i(e){s(e,0,0,e.length)}function X(e,_){var t=0;for(t=0;t<_;++t)s(e[t],0,0,e[t].length)}function Xe(e,_,t){s(e,0,0,8),s(_,0,0,8),4!=t&&9!=t&&(e[8]=0,_[8]=0)}function Ye(e,_,t,o,r){var f=e.tokens[_],d=f.coeffs,n=400*o,m=0,l=e.above_token_entropy_ctx,p=+o,b=f.left_token_entropy_ctx,c=e.mb_info_rows[1+t],v=e.mb_info_rows_off[1+t]+o;for(0==t&&X(l,r),0==o&&i(b),m=o;m<o+r;m++){if(s(d,n,0,400),c[v].base.skip_coeff)Xe(b,l[p],c[v].base.y_mode),c[v].base.eob_mask=0;else{var h,y=0;h=e.dequant_factors,y=+c[v].base.segment_id,c[v].base.eob_mask=a(f.bool,b,l[p],d,n,c[v].base.y_mode,e.entropy_hdr.coeff_probs_,h[y].factor)}p++,v++,n+=400}}function We(e){var _=e.token_hdr.partitions;if(e.frame_hdr.frame_size_updated){var t=0,o=16*(25*e.mb_cols);for(t=0;t<_;t++)e.tokens[t].coeffs=Array(o),e.tokens[t].coeffs||vpx_internal_error(e.error,2,null);e.above_token_entropy_ctx=p(e.mb_cols,e.above_token_entropy_ctx_object),e.above_token_entropy_ctx||vpx_internal_error(e.error,2,null)}}function Qe(e){return 0<=e?e:-e}function Ze(e){return-128>e?-128:127<e?127:e}function Je(e){return 0>e?0:255<e?255:e}function $e(e,_,t,o){var r=e[_-2*t],a=e[_-1*t],f=e[_+0*t],s=e[_+1*t];return Qe(r-a)>o||Qe(s-f)>o}function e_(e,_,t,o){var r=e[_-2*t],a=e[_-1*t],f=e[_+0*t],s=e[_+1*t];return 2*Qe(a-f)+(Qe(r-s)>>1)<=o}function __(e,_,t,o,r){var a=e[_-4*t],f=e[_-3*t],s=e[_-2*t],d=e[_-1*t],i=e[_+0*t],n=e[_+1*t],m=e[_+2*t],l=e[_+3*t],p=r;return e_(e,_,t,2*o+p)&&Qe(a-f)<=p&&Qe(f-s)<=p&&Qe(s-d)<=p&&Qe(l-m)<=p&&Qe(m-n)<=p&&Qe(n-i)<=p}function t_(e,_,t,o){var r=e[_-2*t],f=e[_-1*t],s=e[_+0*t],d=e[_+1*t],i=0,n=0,m=0;i=3*(s-f),o&&(i+=Ze(r-d)),i=Ze(i),n=(127<i+4?127:i+4)>>3,m=(127<i+3?127:i+3)>>3,f=Je(f+m),s=Je(s-n),o||(i=n+1>>1,r=Je(r+i),d=Je(d-i)),e[_-2*t]=r,e[_-1*t]=f,e[_+0*t]=s,e[_+1*t]=d}function o_(e,_,t){var o=e[_-3*t],r=e[_-2*t],f=e[_-1*t],s=e[_+0*t],d=e[_+1*t],i=e[_+2*t],n=0,m=0;n=Ze(Ze(r-d)+3*(s-f)),m=27*n+63>>7,f=Je(f+m),s=Je(s-m),m=18*n+63>>7,r=Je(r+m),d=Je(d-m),m=9*n+63>>7,o=Je(o+m),i=Je(i-m),e[_-3*t]=o,e[_-2*t]=r,e[_-1*t]=f,e[_+0*t]=s,e[_+1*t]=d,e[_+2*t]=i}function r_(e,_,t,o,r,a,f){var s=0;for(s=0;s<8*f;s++)__(e,_,1,o,r)&&($e(e,_,1,a)?t_(e,_,1,1):o_(e,_,1)),_+=t}function a_(e,_,t,o,r,a,f){var s=0;for(s=0;s<8*f;s++)__(e,_,1,o,r)&&t_(e,_,1,$e(e,_,1,a)),_+=t}function f_(e,_,t,o,r,a,f){var s=0;for(s=0;s<8*f;s++)__(e,_,t,o,r)&&($e(e,_,t,a)?t_(e,_,t,1):o_(e,_,t)),_+=1}function s_(e,_,t,o,r,a,f){var s=0;for(s=0;s<8*f;s++)__(e,_,t,o,r)&&t_(e,_,t,$e(e,_,t,a)),_+=1}function d_(e,_,t,o){var r=0;for(r=0;16>r;r++)e_(e,_,1,o)&&t_(e,_,1,1),_+=t}function i_(e,_,t,o){var r=0;for(r=0;16>r;r++)e_(e,_,t,o)&&t_(e,_,t,1),_+=1}function n_(e,_,t,o,r){var a=0,f=0,s=0;a=e.loopfilter_hdr.level,e.segment_hdr.enabled&&(e.segment_hdr.abs_?a=e.segment_hdr.lf_level[_.base.segment_id]:a+=e.segment_hdr.lf_level[_.base.segment_id]),e.loopfilter_hdr.delta_enabled&&(a+=e.loopfilter_hdr.ref_delta[_.base.ref_frame],0==_.base.ref_frame?4==_.base.y_mode&&(a+=e.loopfilter_hdr.mode_delta[0]):7==_.base.y_mode?a+=e.loopfilter_hdr.mode_delta[1]:9==_.base.y_mode?a+=e.loopfilter_hdr.mode_delta[3]:a+=e.loopfilter_hdr.mode_delta[2]),63<a?a=63:0>a&&(a=0),f=a,e.loopfilter_hdr.sharpness&&(f>>=4<e.loopfilter_hdr.sharpness?2:1,f>9-e.loopfilter_hdr.sharpness&&(f=9-e.loopfilter_hdr.sharpness)),1>f&&(f=1),s=15<=a,40<=a&&s++,20<=a&&!e.frame_hdr.is_keyframe&&s++,t[0]=a,o[0]=f,r[0]=s}function m_(e,_,t,o){var r,a=0,f=0,s=0,d=0,i=0,n=0,m=0,l=0,p=0,b=0;for(m=e.ref_frames[0].img.stride[0],l=e.ref_frames[0].img.stride[1],a=e.ref_frames[0].img.planes[0],d=e.ref_frames[0].img.planes_off[0],f=e.ref_frames[0].img.planes[1],i=e.ref_frames[0].img.planes_off[1],s=e.ref_frames[0].img.planes[2],n=e.ref_frames[0].img.planes_off[2],d+=16*(m*_+t),i+=8*(l*_+t),n+=8*(l*_+t),r=e.mb_info_rows[1+_],p=e.mb_info_rows_off[1+_]+t,b=t;b<t+o;b++){var c=[0],h=[0],g=[0];n_(e,r[p],c,h,g),c=c[0],h=h[0],g=g[0],c&&(b&&(r_(a,d,m,c+2,h,g,2),r_(f,i,l,c+2,h,g,1),r_(s,n,l,c+2,h,g,1)),(r[p].base.eob_mask||9==r[p].base.y_mode||4==r[p].base.y_mode)&&(a_(a,d+4,m,c,h,g,2),a_(a,d+8,m,c,h,g,2),a_(a,d+12,m,c,h,g,2),a_(f,i+4,l,c,h,g,1),a_(s,n+4,l,c,h,g,1)),_&&(f_(a,d,m,c+2,h,g,2),f_(f,i,l,c+2,h,g,1),f_(s,n,l,c+2,h,g,1)),(r[p].base.eob_mask||9==r[p].base.y_mode||4==r[p].base.y_mode)&&(s_(a,d+4*m,m,c,h,g,2),s_(a,d+8*m,m,c,h,g,2),s_(a,d+12*m,m,c,h,g,2),s_(f,i+4*l,l,c,h,g,1),s_(s,n+4*l,l,c,h,g,1))),d+=16,i+=8,n+=8,p++}}function l_(e,_,t,o){var r,a=0,f=0,s=0,d=0,i=0;for(s=e.ref_frames[0].img.stride[0],a=e.ref_frames[0].img.planes[0],f=e.ref_frames[0].img.planes_off[0],f+=16*(s*_+t),r=e.mb_info_rows[1+_],d=e.mb_info_rows_off[1+_]+t,i=t;i<t+o;i++){var n=[0],m=[0];if(n_(e,r[d],n,m,[0]),n[0]){var l=(r[d].base.eob_mask||9==r[d].base.y_mode||4==r[d].base.y_mode)+0,p=2*(n[0]+2)+m[0],b=2*n[0]+m[0];i&&d_(a,f,s,p),l&&(d_(a,f+4,s,b),d_(a,f+8,s,b),d_(a,f+12,s,b)),_&&i_(a,f,s,p),l&&(i_(a,f+4*s,s,b),i_(a,f+8*s,s,b),i_(a,f+12*s,s,b))}f+=16,d++}}function p_(e,_,t,o){e.loopfilter_hdr.use_simple?l_(e,_,t,o):m_(e,_,t,o)}function b_(e,_,t,o){var r=0,a=0;for(r=0;r<o;r++)for(a=0;a<o;a++)e[_+r*t+a]=e[_-1+r*t]}function c_(e,_,t,o){var r=0,a=0;for(r=0;r<o;r++)for(a=0;a<o;a++)e[_+r*t+a]=e[_-t+a]}function v_(e,_,t,o){var r=_-1,a=e,f=_-t,s=a[f-1],d=0,n=0;for(n=0;n<o;n++){for(d=0;d<o;d++)e[_+d]=De(e[r]+a[f+d]-s);_+=t,r+=t}}function h_(e,_,t,o){var r=_-1,a=0,f=0,s=0;for(a=0;a<o;a++)s+=e[r]+e[_-t+a],r+=t;for(16===o?s=s+16>>5:8===o?s=s+8>>4:4===o?s=s+4>>3:void 0,a=0;a<o;a++)for(f=0;f<o;f++)e[_+a*t+f]=s}function y_(e,_,t){var o=e,r=_-t,a=0,f=0;for(e[_+0]=o[r-1]+2*o[r+0]+o[r+1]+2>>2,e[_+1]=o[r+0]+2*o[r+1]+o[r+2]+2>>2,e[_+2]=o[r+1]+2*o[r+2]+o[r+3]+2>>2,e[_+3]=o[r+2]+2*o[r+3]+o[r+4]+2>>2,a=1;4>a;a++)for(f=0;4>f;f++)e[_+a*t+f]=e[_+f]}function g_(e,_,t){var o=e,r=_-1;e[_+0]=e[_+1]=e[_+2]=e[_+3]=o[r-t]+2*o[r+0]+o[r+t]+2>>2,_+=t,r+=t,e[_+0]=e[_+1]=e[_+2]=e[_+3]=o[r-t]+2*o[r+0]+o[r+t]+2>>2,_+=t,r+=t,e[_+0]=e[_+1]=e[_+2]=e[_+3]=o[r-t]+2*o[r+0]+o[r+t]+2>>2,_+=t,r+=t,e[_+0]=e[_+1]=e[_+2]=e[_+3]=o[r-t]+2*o[r+0]+o[r+0]+2>>2}function u_(e,_,t){var o=e,r=_-t,a=0,f=0,s=0,d=0,i=0,n=0,m=0;e[_+0]=a=o[r+0]+2*o[r+1]+o[r+2]+2>>2,e[_+1]=f=o[r+1]+2*o[r+2]+o[r+3]+2>>2,e[_+2]=s=o[r+2]+2*o[r+3]+o[r+4]+2>>2,e[_+3]=d=o[r+3]+2*o[r+4]+o[r+5]+2>>2,_+=t,e[_+0]=f,e[_+1]=s,e[_+2]=d,e[_+3]=i=o[r+4]+2*o[r+5]+o[r+6]+2>>2,_+=t,e[_+0]=s,e[_+1]=d,e[_+2]=i,e[_+3]=n=o[r+5]+2*o[r+6]+o[r+7]+2>>2,_+=t,e[_+0]=d,e[_+1]=i,e[_+2]=n,e[_+3]=m=o[r+6]+2*o[r+7]+o[r+7]+2>>2}function x_(e,_,t){var o=e,r=_-1,a=e,f=_-t,s=0,d=0,i=0,n=0,m=0,l=0,p=0;e[_+0]=s=o[r+0]+2*a[f-1]+a[f+0]+2>>2,e[_+1]=d=a[f-1]+2*a[f+0]+a[f+1]+2>>2,e[_+2]=i=a[f+0]+2*a[f+1]+a[f+2]+2>>2,e[_+3]=n=a[f+1]+2*a[f+2]+a[f+3]+2>>2,_+=t,e[_+0]=m=o[r+t]+2*o[r+0]+a[f-1]+2>>2,e[_+1]=s,e[_+2]=d,e[_+3]=i,_+=t,e[_+0]=l=o[r+2*t]+2*o[r+t]+o[r+0]+2>>2,e[_+1]=m,e[_+2]=s,e[_+3]=d,_+=t,e[_+0]=p=o[r+3*t]+2*o[r+2*t]+o[r+t]+2>>2,e[_+1]=l,e[_+2]=m,e[_+3]=s}function k_(e,_,t){var o=e,r=_-1,a=e,f=_-t,s=0,d=0,i=0,n=0,m=0,l=0,p=0,b=0,c=0,v=0;e[_+0]=s=a[f-1]+a[f+0]+1>>1,e[_+1]=d=a[f+0]+a[f+1]+1>>1,e[_+2]=i=a[f+1]+a[f+2]+1>>1,e[_+3]=n=a[f+2]+a[f+3]+1>>1,_+=t,e[_+0]=m=o[r+0]+2*a[f-1]+a[f+0]+2>>2,e[_+1]=l=a[f-1]+2*a[f+0]+a[f+1]+2>>2,e[_+2]=p=a[f+0]+2*a[f+1]+a[f+2]+2>>2,e[_+3]=b=a[f+1]+2*a[f+2]+a[f+3]+2>>2,_+=t,e[_+0]=c=o[r+t]+2*o[r+0]+a[f-1]+2>>2,e[_+1]=s,e[_+2]=d,e[_+3]=i,_+=t,e[_+0]=v=o[r+2*t]+2*o[r+t]+o[r+0]+2>>2,e[_+1]=m,e[_+2]=l,e[_+3]=p}function I_(e,_,t){var o=e,r=_-t,a=0,f=0,s=0,d=0,i=0,n=0,m=0,l=0,p=0,b=0;e[_+0]=a=o[r+0]+o[r+1]+1>>1,e[_+1]=f=o[r+1]+o[r+2]+1>>1,e[_+2]=s=o[r+2]+o[r+3]+1>>1,e[_+3]=d=o[r+3]+o[r+4]+1>>1,_+=t,e[_+0]=i=o[r+0]+2*o[r+1]+o[r+2]+2>>2,e[_+1]=n=o[r+1]+2*o[r+2]+o[r+3]+2>>2,e[_+2]=m=o[r+2]+2*o[r+3]+o[r+4]+2>>2,e[_+3]=l=o[r+3]+2*o[r+4]+o[r+5]+2>>2,_+=t,e[_+0]=f,e[_+1]=s,e[_+2]=d,e[_+3]=p=o[r+4]+2*o[r+5]+o[r+6]+2>>2,_+=t,e[_+0]=n,e[_+1]=m,e[_+2]=l,e[_+3]=b=o[r+5]+2*o[r+6]+o[r+7]+2>>2}function D_(e,_,t){var o=e,r=_-1,a=e,f=_-t,s=0,d=0,i=0,n=0,m=0,l=0,p=0,b=0,c=0,v=0;e[_+0]=s=o[r+0]+a[f-1]+1>>1,e[_+1]=d=o[r+0]+2*a[f-1]+a[f+0]+2>>2,e[_+2]=i=a[f-1]+2*a[f+0]+a[f+1]+2>>2,e[_+3]=n=a[f+0]+2*a[f+1]+a[f+2]+2>>2,_+=t,e[_+0]=m=o[r+t]+o[r+0]+1>>1,e[_+1]=l=o[r+t]+2*o[r+0]+a[f-1]+2>>2,e[_+2]=s,e[_+3]=d,_+=t,e[_+0]=p=o[r+2*t]+o[r+t]+1>>1,e[_+1]=b=o[r+2*t]+2*o[r+t]+o[r+0]+2>>2,e[_+2]=m,e[_+3]=l,_+=t,e[_+0]=c=o[r+3*t]+o[r+2*t]+1>>1,e[_+1]=v=o[r+3*t]+2*o[r+2*t]+o[r+t]+2>>2,e[_+2]=p,e[_+3]=b}function w_(e,_,t){var o=e,r=_-1,a=0,f=0,s=0,d=0,i=0,n=0,m=0;e[_+0]=a=o[r+0*t]+o[r+1*t]+1>>1,e[_+1]=f=o[r+0*t]+2*o[r+1*t]+o[r+2*t]+2>>2,e[_+2]=s=o[r+1*t]+o[r+2*t]+1>>1,e[_+3]=d=o[r+1*t]+2*o[r+2*t]+o[r+3*t]+2>>2,_+=t,e[_+0]=s,e[_+1]=d,e[_+2]=i=o[r+2*t]+o[r+3*t]+1>>1,e[_+3]=n=o[r+2*t]+2*o[r+3*t]+o[r+3*t]+2>>2,_+=t,e[_+0]=i,e[_+1]=n,e[_+2]=m=o[r+3*t],e[_+3]=m,_+=t,e[_+0]=m,e[_+1]=m,e[_+2]=m,e[_+3]=m}function E_(e,_,t){b_(e,_,t,16)}function q_(e,_,t){c_(e,_,t,16)}function C_(e,_,t){v_(e,_,t,16)}function T_(e,_,t){b_(e,_,t,8)}function O_(e,_,t){c_(e,_,t,8)}function L_(e,_,t){v_(e,_,t,8)}function z_(e,_,t){v_(e,_,t,4)}function R_(e,_,t){var o,r=e,a=_+16-t;for(o=0;4>o;++o)_a[0+o]=r[a+o];for(a+=4*t,o=0;4>o;++o)r[a+o]=_a[0+o];for(a+=4*t,o=0;4>o;++o)r[a+o]=_a[0+o];for(a+=4*t,o=0;4>o;++o)r[a+o]=_a[0+o]}function A_(e,_,t,o,r,a){var f=0;for(R_(e,_,t),f=0;16>f;f++){var s=e,d=_+4*(3&f);switch(o.splitt.mvs[f].d.x){case 0:h_(s,d,t,4);break;case 1:z_(s,d,t);break;case 2:y_(s,d,t);break;case 3:g_(s,d,t);break;case 4:u_(s,d,t);break;case 5:x_(s,d,t);break;case 6:k_(s,d,t);break;case 7:I_(s,d,t);break;case 8:D_(s,d,t);break;case 9:w_(s,d,t);break;default:n(0);}qe(s,d,s,d,t,r,a),a+=16,3==(3&f)&&(_+=4*t)}}function P_(e,_,t){var o=0;for(we(_,t+384,ta,0),o=0;16>o;o++)_[t+16*o]=ta[o]}function S_(e,_,t,o,r,a){if(4==o.base.y_mode)A_(e,_,t,o,r,a);else{var f=0;switch(o.base.y_mode){case 0:h_(e,_,t,16);break;case 1:q_(e,_,t);break;case 2:E_(e,_,t);break;case 3:C_(e,_,t);break;default:n(0);}for(P_(o,r,a),f=0;16>f;f++)qe(e,_,e,_,t,r,a),a+=16,_+=4,3==(3&f)&&(_+=4*t-16)}}function N_(e,_,t,o,r,a,f,s){var d=0;switch(a.base.uv_mode){case 0:h_(e,_,r,8),h_(t,o,r,8);break;case 1:O_(e,_,r),O_(t,o,r);break;case 2:T_(e,_,r),T_(t,o,r);break;case 3:L_(e,_,r),L_(t,o,r);break;default:n(0);}for(s+=256,d=16;20>d;d++)qe(e,_,e,_,r,f,s),s+=16,_+=4,1&d&&(_+=4*r-8);for(d=20;24>d;d++)qe(t,o,t,o,r,f,s),s+=16,o+=4,1&d&&(o+=4*r-8)}function j_(e,_,t,o,a,f,s,d,i){var n=0,m=0,l=0;for(n=0;n<d;n++){for(m=0;m<s;m++)l=o[a-2]*i[0]+o[a-1]*i[1]+o[a+0]*i[2]+o[a+1]*i[3]+o[a+2]*i[4]+o[a+3]*i[5]+64,l>>=7,e[_+m]=l,a++;a+=f-s,_+=t}}function B_(e,_,t,o,a,f,s,d,i){var n=0,m=0,l=0;for(n=0;n<d;n++){for(m=0;m<s;m++)l=o[a-2*f]*i[0]+o[a-1*f]*i[1]+o[a+0*f]*i[2]+o[a+1*f]*i[3]+o[a+2*f]*i[4]+o[a+3*f]*i[5]+64,l>>=7,e[_+m]=l,a++;a+=f-s,_+=t}}function U_(e,_,t,o,r,a,f,s,d,i,n){j_(oa,0,16,o,r-2*a,a,f,s+5,n[d]),B_(e,_,t,oa,32,16,f,s,n[i])}function K_(e,_,t,o,r,a,f,s){var d=0,i=0;return f.d.x||f.d.y?(d=7&f.d.x,i=7&f.d.y,r+=(f.d.y>>3)*a+(f.d.x>>3),d|i&&(U_(_,t,a,o,r,a,4,4,d,i,s),o=_,r=t),e[0]=r,o):(e[0]=r,o)}function M_(e,_,t,o,r,a,f,s,d,i,n){var m=0,l=0,p=[0];m=K_(p,e,_,t,o,r,a,f),l=p[0],qe(e,_,m,l,r,s,d+16*n)}function G_(e,_,t){var o=0,r=new sr;return o=e.splitt.mvs[_].d.x+e.splitt.mvs[_+1].d.x+e.splitt.mvs[_+4].d.x+e.splitt.mvs[_+5].d.x,0>o?o-=4:o+=4,r.d.x=parseInt(o/8,10),o=e.splitt.mvs[_].d.y+e.splitt.mvs[_+1].d.y+e.splitt.mvs[_+4].d.y+e.splitt.mvs[_+5].d.y,0>o?o-=4:o+=4,r.d.y=parseInt(o/8,10),t&&(r.d.x&=-8,r.d.y&=-8),r}function F_(e,_,t,o,r,a,d,i,n,m,l){var p=0,b=0;p=t,b=o-a-d*r,d>=l?b+=(l-1)*r:0<d&&(b+=d*r);do{var c=0,v=0,h=0;c=0>a?-a:0,c>i&&(c=i),a+i>m&&(v=a+i-m),v>i&&(v=i),h=i-c-v,c&&s(e,_,p[b+0],c),h&&f(e,_+c,p,b+a+c,h),v&&s(e,_+c+h,p[b+m-1],v),_+=r,d++,d<l&&0<d&&(b+=r)}while(--n)}function H_(e,_,t,o,r,a,f,s,d,i,n,m,l,p,b,c,v){var h=0,g=0,u=4,k=4;l+=s.d.x>>3,p+=s.d.y>>3,(2>l||l+u-1+3>=b||2>p||p+k-1+3>=c)&&(a+=(s.d.x>>3)+(s.d.y>>3)*f,F_(t,o,r,a-2-2*f,f,l-2,p-2,u+5,k+5,b,c),r=t,a=o+2*f+2,a-=(s.d.x>>3)+(s.d.y>>3)*f);var I=[0];h=K_(I,e,_,r,a,f,s,d),g=I[0],qe(e,_,h,g,f,i,n+16*v)}function V_(e,_,t,o,r,a,f){var s=e.frame_strg[0].img.img_data,d=e.frame_strg[0].img.img_data_off,i=0,n=0,m=0,l=0,c=0,g=0,k=0,I=0,D=0,E=0,q=p(4,sr),C=_.u,u=_.v,v=_.u_off,T=_.v_off,O=(3==e.frame_hdr.version)+0;if(I=16*a,D=16*f,g=16*e.mb_cols,k=16*e.mb_rows,m=_.y,l=_.y_off,c=e.ref_frame_offsets[r.base.ref_frame],i=e.ref_frame_offsets_[r.base.ref_frame],n=l+c,9!=r.base.y_mode){var L=ra;L.d.x=r.base.mv.d.x,L.d.y=r.base.mv.d.y,L.d.x=L.d.x+1>>1,L.d.y=L.d.y+1>>1,O&&(L.d.x&=-8,L.d.y&=-8),q[0].d.x=L.d.x,q[0].d.y=L.d.y,q[1].d.x=L.d.x,q[1].d.y=L.d.y,q[2].d.x=L.d.x,q[2].d.y=L.d.y,q[3].d.x=L.d.x,q[3].d.y=L.d.y}else q[0]=G_(r,0,O),q[1]=G_(r,2,O),q[2]=G_(r,8,O),q[3]=G_(r,10,O);for(E=0;16>E;E++){var z;z=9==r.base.y_mode?r.splitt.mvs[+E]:r.base.mv,H_(m,l,s,d,i,n,_.stride,z,e.subpixel_filters,t,o,r,I,D,g,k,E),I+=4,l+=4,n+=4,3==(3&E)&&(I-=16,D+=4,l+=4*_.stride-16,n+=4*_.stride-16)}for(I=16*a,D=16*f,I>>=1,D>>=1,g>>=1,k>>=1,E=0;4>E;E++)H_(C,v,s,d,i,v+c,_.uv_stride,q[E],e.subpixel_filters,t,o,r,I,D,g,k,E+16),H_(u,T,s,d,i,T+c,_.uv_stride,q[E],e.subpixel_filters,t,o,r,I,D,g,k,E+20),v+=4,T+=4,I+=4,1&E&&(I-=8,D+=4,v+=4*_.uv_stride-8,T+=4*_.uv_stride-8)}function X_(e,_,t,o,r){var a,f=_.y,s=_.y_off,d=_.u,i=_.u_off,n=_.v,m=_.v_off,l=0,c=p(4,sr),v=(3==e.frame_hdr.version)+0,h=0;if(9!=r.base.y_mode){var y=aa;y.d.x=r.base.mv.d.x,y.d.y=r.base.mv.d.y,y.d.x=y.d.x+1>>1,y.d.y=y.d.y+1>>1,v&&(y.d.x&=-8,y.d.y&=-8),c[0].d.x=c[1].d.x=c[2].d.x=c[3].d.x=y.d.x,c[0].d.y=c[1].d.y=c[2].d.y=c[3].d.y=y.d.y}else c[0]=G_(r,0,v),c[1]=G_(r,2,v),c[2]=G_(r,8,v),c[3]=G_(r,10,v);for(l=e.ref_frame_offsets[r.base.ref_frame],a=e.ref_frame_offsets_[r.base.ref_frame],h=0;16>h;h++){var g;g=9==r.base.y_mode?r.splitt.mvs[+h]:r.base.mv,M_(f,s,a,s+l,_.stride,g,e.subpixel_filters,t,o,r,h),s+=4,3==(3&h)&&(s+=4*_.stride-16)}for(h=0;4>h;h++)M_(d,i,a,i+l,_.uv_stride,c[h],e.subpixel_filters,t,o,r,h+16),M_(n,m,a,m+l,_.uv_stride,c[h],e.subpixel_filters,t,o,r,h+20),i+=4,m+=4,1&h&&(i+=4*_.uv_stride-8,m+=4*_.uv_stride-8)}function Y_(e){e&&(n(e.ref_cnt),e.ref_cnt--)}function W_(e){return e.ref_cnt++,e}function Q_(e){var _=0;for(_=0;4>_;_++)if(0==e[_].ref_cnt)return e[_].ref_cnt=1,e[_];return n(0),null}function Z_(e,_,t,o,r,a){var f=e,s=_-1,d=0;if(0==a&&r){for(d=0;d<t;d++)f[s]=e[_-o+d],s+=o}else for(s-=o,d=-1;d<t;d++)f[s]=129,s+=o}function J_(e,_,t,o,r,a){var f=e,d=_-o,n=0;if(0==a&&r){var m=_-1;for(n=0;n<t;n++)f[d+n]=e[m],m+=o}else s(f,d-1,127,t+1);s(f,d+t,127,4)}function $_(e){var _=0,t=0;if(e.frame_hdr.frame_size_updated){for(_=0;4>_;_++){var o=16*e.mb_cols+32,r=16*e.mb_rows+32;be(e.frame_strg[_].img),e.frame_strg[_].ref_cnt=0,e.ref_frames[_]=null,le(e.frame_strg[_].img,Fo,o,r,16)||vpx_internal_error(e.error,2,"Failed to allocate %dx%d framebuffer",o,r),pe(e.frame_strg[_].img,16,16,e.frame_hdr.kf.w,e.frame_hdr.kf.h)}e.subpixel_filters=e.frame_hdr.version?ea:$r}for(e.ref_frames[0]&&Y_(e.ref_frames[0]),e.ref_frames[0]=Q_(e.frame_strg),t=e.ref_frames[0].img.img_data,_=0;4>_;_++){var a=e.ref_frames[_];e.ref_frame_offsets[_]=a?a.img.img_data_off-0:0,e.ref_frame_offsets_[_]=a?a.img.img_data:t}}function et(e,_,t,o){var r,a=fa,f=0,s=0,d=0,i=0;for(a.stride=e.ref_frames[0].img.stride[0],a.uv_stride=e.ref_frames[0].img.stride[1],a.y=e.ref_frames[0].img.planes[0],a.y_off=e.ref_frames[0].img.planes_off[0],a.u=e.ref_frames[0].img.planes[1],a.u_off=e.ref_frames[0].img.planes_off[1],a.v=e.ref_frames[0].img.planes[2],a.v_off=e.ref_frames[0].img.planes_off[2],a.y_off+=16*(a.stride*_+t),a.u_off+=8*(a.uv_stride*_+t),a.v_off+=8*(a.uv_stride*_+t),r=e.mb_info_rows[1+_],f=e.mb_info_rows_off[1+_]+t,d=e.tokens[_&e.token_hdr.partitions-1].coeffs,i=400*t,0==t&&(Z_(a.y,a.y_off,16,a.stride,_,r[f].base.y_mode),Z_(a.u,a.u_off,8,a.uv_stride,_,r[f].base.uv_mode),Z_(a.v,a.v_off,8,a.uv_stride,_,r[f].base.uv_mode),0==_&&(a.y[a.y_off-a.stride-1]=127)),s=t;s<t+o;s++)0==_&&(J_(a.y,a.y_off,16,a.stride,s,r[f].base.y_mode),J_(a.u,a.u_off,8,a.uv_stride,s,r[f].base.uv_mode),J_(a.v,a.v_off,8,a.uv_stride,s,r[f].base.uv_mode)),4>=r[f].base.y_mode?(S_(a.y,a.y_off,a.stride,r[f],d,i),N_(a.u,a.u_off,a.v,a.v_off,a.uv_stride,r[f],d,i)):(9!=r[f].base.y_mode&&P_(r[f],d,i),r[f].base.need_mc_border?V_(e,a,d,i,r[f],s,_):X_(e,a,d,i,r[f])),f++,a.y_off+=16,a.u_off+=8,a.v_off+=8,i+=400;if(s==e.mb_cols){var n=a.y,m=a.y_off+15*a.stride,l=a.y[a.y_off-1+15*a.stride];n[m]=n[m+1]=n[m+2]=n[m+3]=l}}function _t(e,_){n(e.length==_.length),f(e,0,_,0,e.length)}function tt(e,_,t){var o=0,r=0,a=0,f=0,s=0;for(o=0;4>o;o++)for(r=0;8>r;r++)for(a=0;3>a;a++)for(f=0;11>f;f++)ve(_,vr[o][r][a][f])&&(t.coeff_probs_[s]=t.coeff_probs[o][r][a][f]=ye(_,8)),s++;if(t.coeff_skip_enabled=he(_),t.coeff_skip_enabled&&(t.coeff_skip_prob=ye(_,8)),!e.frame_hdr.is_keyframe){if(t.prob_inter=ye(_,8),t.prob_last=ye(_,8),t.prob_gf=ye(_,8),he(_))for(o=0;4>o;o++)t.y_mode_probs[o]=ye(_,8);if(he(_))for(o=0;3>o;o++)t.uv_mode_probs[o]=ye(_,8);for(o=0;2>o;o++)for(r=0;19>r;r++)if(ve(_,ur[o][r])){var d=ye(_,7);t.mv_probs[o][r]=d?d<<1:1}}}function ot(e,_,t){var o=e.frame_hdr.is_keyframe;t.refresh_gf=o?1:he(_),t.refresh_arf=o?1:he(_),t.copy_gf=o?0:t.refresh_gf?0:ye(_,2),t.copy_arf=o?0:t.refresh_arf?0:ye(_,2),t.sign_bias[2]=o?0:he(_),t.sign_bias[3]=o?0:he(_),t.refresh_entropy=he(_),t.refresh_last=o?1:he(_)}function rt(e,_,t){var o=0,r=t.q_index;t.q_index=ye(_,7),o=(r!=t.q_index)+0,o|=t.y1_dc_delta_q=ue(_,4),o|=t.y2_dc_delta_q=ue(_,4),o|=t.y2_ac_delta_q=ue(_,4),o|=t.uv_dc_delta_q=ue(_,4),o|=t.uv_ac_delta_q=ue(_,4),t.delta_update=o}function at(e,_,t,o,r,a){var f=0;for(a.partitions=1<<ye(_,2),r<3*(a.partitions-1)&&vpx_internal_error(e.error,VPX_CODEC_CORRUPT_FRAME,"Truncated packet found parsing partition lengths."),r-=3*(a.partitions-1),f=0;f<a.partitions;f++)f<a.partitions-1?(a.partition_sz[f]=t[o+2]<<16|t[o+1]<<8|t[o+0],o+=3):a.partition_sz[f]=r,r<a.partition_sz[f]&&vpx_internal_error(e.error,VPX_CODEC_CORRUPT_FRAME,"Truncated partition %d",f),r-=a.partition_sz[f];for(f=0;f<e.token_hdr.partitions;f++)ce(e.tokens[f].bool,t,o,e.token_hdr.partition_sz[f]),o+=e.token_hdr.partition_sz[f]}function ft(e,_,t){if(e.frame_hdr.is_keyframe&&s(t,0,1),t.use_simple=he(_),t.level=ye(_,6),t.sharpness=ye(_,3),t.delta_enabled=he(_),t.delta_enabled&&he(_)){var o=0;for(o=0;4>o;o++)t.ref_delta[o]=ue(_,6);for(o=0;4>o;o++)t.mode_delta[o]=ue(_,6)}}function st(e,_,t){if(e.frame_hdr.is_keyframe&&s(t,0,1),t.enabled=he(_),t.enabled){var o=0;if(t.update_map=he(_),t.update_data=he(_),t.update_data){for(t.abs_=he(_),o=0;4>o;o++)t.quant_idx[o]=ue(_,7);for(o=0;4>o;o++)t.lf_level[o]=ue(_,6)}if(t.update_map)for(o=0;3>o;o++)t.tree_probs[o]=he(_)?ye(_,8):255}else t.update_map=0,t.update_data=0}function dt(e){return 0>e?0:127<e?127:e}function it(e){return kr[dt(e)]}function nt(e){return Ir[dt(e)]}function mt(e,_,t){var o=0,r=0,a=e,f=0;for(o=0;o<(_.enabled?4:1);o++)r=t.q_index,_.enabled&&(r=_.abs_?_.quant_idx[o]:r+_.quant_idx[o]),(a[f].quant_idx!=r||t.delta_update)&&(a[f].factor[0][0]=it(r+t.y1_dc_delta_q),a[f].factor[0][1]=nt(r),a[f].factor[1][0]=it(r+t.uv_dc_delta_q),a[f].factor[1][1]=nt(r+t.uv_ac_delta_q),a[f].factor[2][0]=2*it(r+t.y2_dc_delta_q),a[f].factor[2][1]=parseInt(155*nt(r+t.y2_ac_delta_q)/100),8>a[f].factor[2][1]&&(a[f].factor[2][1]=8),132<a[f].factor[1][0]&&(a[f].factor[1][0]=132),a[f].quant_idx=r),f++}function lt(e,_,t,o){var r,a=sa,f=0,s=0,d=0;if(e.saved_entropy_valid=0,(r=bt(_,o,e.frame_hdr))&&vpx_internal_error(e.error,r,"Failed to parse frame header"),e.frame_hdr.is_experimental&&vpx_internal_error(e.error,VPX_CODEC_UNSUP_BITSTREAM,"Experimental bitstreams not supported."),t+=3,o-=3,e.frame_hdr.is_keyframe&&(t+=7,o-=7,e.mb_cols=parseInt((e.frame_hdr.kf.w+15)/16,10),e.mb_rows=parseInt((e.frame_hdr.kf.h+15)/16,10)),ce(a,_,t,e.frame_hdr.part0_sz),e.frame_hdr.is_keyframe&&ye(a,2)&&vpx_internal_error(e.error,VPX_CODEC_UNSUP_BITSTREAM,"Reserved bits not supported."),st(e,a,e.segment_hdr),ft(e,a,e.loopfilter_hdr),at(e,a,_,t+e.frame_hdr.part0_sz,o-e.frame_hdr.part0_sz,e.token_hdr),rt(e,a,e.quant_hdr),ot(e,a,e.reference_hdr),e.frame_hdr.is_keyframe){var f=0,n=0,m=0,p=0,b=0;for(f=0;4>f;f++)for(n=0;8>n;n++)for(m=0;3>m;m++)for(p=0;11>p;p++)e.entropy_hdr.coeff_probs_[b]=e.entropy_hdr.coeff_probs[f][n][m][p]=gr[f][n][m][p],b++;e.entropy_hdr.mv_probs=new xr,_t(e.entropy_hdr.y_mode_probs,hr),_t(e.entropy_hdr.uv_mode_probs,yr)}if(!e.reference_hdr.refresh_entropy){var c=e.saved_entropy,v=e.entropy_hdr,b=0;for(f=0;4>f;f++)for(n=0;8>n;n++)for(m=0;3>m;m++)for(p=0;11>p;p++)c.coeff_probs_[b]=c.coeff_probs[f][n][m][p]=v.coeff_probs[f][n][m][p],b++;for(c.coeff_skip_enabled=v.coeff_skip_enabled,c.coeff_skip_prob=v.coeff_skip_prob,f=0;2>f;++f)for(n=0;19>n;++n)c.mv_probs[f][n]=v.mv_probs[f][n];for(c.prob_gf=v.prob_gf,c.prob_inter=v.prob_inter,c.prob_last=v.prob_last,f=0;3>f;++f)c.uv_mode_probs[f]=v.uv_mode_probs[f];for(f=0;4>f;++f)c.y_mode_probs[f]=v.y_mode_probs[f];e.saved_entropy_valid=1}for(tt(e,a,e.entropy_hdr),He(e),We(e),$_(e),mt(e.dequant_factors,e.segment_hdr,e.quant_hdr),(s=0,d=0);s<e.mb_rows;s++)Fe(e,a,s,0,e.mb_cols),Ye(e,d,s,0,e.mb_cols),et(e,s,0,e.mb_cols),e.loopfilter_hdr.level&&s&&p_(e,s-1,0,e.mb_cols),++d==e.token_hdr.partitions&&(d=0);if(e.loopfilter_hdr.level&&p_(e,s-1,0,e.mb_cols),e.frame_cnt++,!e.reference_hdr.refresh_entropy){var c=e.entropy_hdr,v=e.saved_entropy,b=0;for(f=0;4>f;f++)for(n=0;8>n;n++)for(m=0;3>m;m++)for(p=0;11>p;p++)c.coeff_probs_[b]=c.coeff_probs[f][n][m][p]=v.coeff_probs[f][n][m][p]=v.coeff_probs_[b],b++;for(c.coeff_skip_enabled=v.coeff_skip_enabled,c.coeff_skip_prob=v.coeff_skip_prob,f=0;2>f;++f)for(n=0;19>n;++n)c.mv_probs[f][n]=v.mv_probs[f][n];for(c.prob_gf=v.prob_gf,c.prob_inter=v.prob_inter,c.prob_last=v.prob_last,f=0;3>f;++f)c.uv_mode_probs[f]=v.uv_mode_probs[f];for(f=0;4>f;++f)c.y_mode_probs[f]=v.y_mode_probs[f];e.saved_entropy_valid=0}1==e.reference_hdr.copy_arf?(Y_(e.ref_frames[3]),e.ref_frames[3]=W_(e.ref_frames[1])):2==e.reference_hdr.copy_arf&&(Y_(e.ref_frames[3]),e.ref_frames[3]=W_(e.ref_frames[2])),1==e.reference_hdr.copy_gf?(Y_(e.ref_frames[2]),e.ref_frames[2]=W_(e.ref_frames[1])):2==e.reference_hdr.copy_gf&&(Y_(e.ref_frames[2]),e.ref_frames[2]=W_(e.ref_frames[3])),e.reference_hdr.refresh_gf&&(Y_(e.ref_frames[2]),e.ref_frames[2]=W_(e.ref_frames[0])),e.reference_hdr.refresh_arf&&(Y_(e.ref_frames[3]),e.ref_frames[3]=W_(e.ref_frames[0])),e.reference_hdr.refresh_last&&(Y_(e.ref_frames[1]),e.ref_frames[1]=W_(e.ref_frames[0]))}function pt(e,_,t){{var o=e;t[0]|=o!=(e=_)}return e}function bt(e,_,t){var o=0;if(10>_)return VPX_CODEC_CORRUPT_FRAME;if(o=e[0]|e[1]<<8|e[2]<<16,t.is_keyframe=!Ie(o,0,1),t.version=Ie(o,1,2),t.is_experimental=Ie(o,3,1),t.is_shown=Ie(o,4,1),t.part0_sz=Ie(o,5,19),_<=t.part0_sz+(t.is_keyframe?10:3))return VPX_CODEC_CORRUPT_FRAME;if(t.frame_size_updated=0,t.is_keyframe){var r=[0];if(157!=e[3]||1!=e[4]||42!=e[5])return VPX_CODEC_UNSUP_BITSTREAM;if(o=e[6]|e[7]<<8|e[8]<<16|e[9]<<24,t.kf.w=pt(t.kf.w,Ie(o,0,14),r),t.kf.scale_w=pt(t.kf.scale_w,Ie(o,14,2),r),t.kf.h=pt(t.kf.h,Ie(o,16,14),r),t.kf.scale_h=pt(t.kf.scale_h,Ie(o,30,2),r),t.frame_size_updated=r[0],!t.kf.w||!t.kf.h)return VPX_CODEC_UNSUP_BITSTREAM}return 0}function ct(e,_,t){return e.error.error_code=0,e.error.has_detail=0,m(e.error.jmp)||lt(e,_,0,t),e.error.error_code}function vt(e){return kt(e)}function ht(e,t,o,r){var a=Array(12),f=e.infile,s=e.kind;if(2==s){if(e.chunk>=e.chunks){var d=[0];do if(e.pkt&&se(e.pkt),0>=fe(e.nestegg_ctx,e.pkt)||de(e.pkt,d))return 1;while(d!=e.video_track);if(ie(e.pkt,e.chunks))return 1;e.chunk=0}return ne(e.pkt,e.chunk,t,r)?1:(e.chunk++,0)}return r[0]=0,r?_(t,1,r[0],f)==r[0]?0:(fprintf(stderr,"Failed to read full frame\n"),1):1}function yt(e,t,r){var a=r;return _(e,1,t,a)<t&&o(a)?0:1}function gt(e,_,t){return 0===_?_=0:1===_?_=1:2===_?_=2:void 0,fseek(t,e,_)?-1:0}function ut(e){return t(e)}function xt(e,_,t,o,r,a){var f=0,s=[0],d=-1,n={read:yt,seek:gt,tell:ut,userdata:e.infile},m=new Ft;for(e.nestegg_ctx=[e.nestegg_ctx],ee(e.nestegg_ctx,n,null)&&alert("goto fail"),e.nestegg_ctx=e.nestegg_ctx[0],te(e.nestegg_ctx,s)&&alert("goto fail"),f=0;f<s&&(d=oe(e.nestegg_ctx,f),0!=d);f++)0>d&&alert("goto fail");return 0!=re(e.nestegg_ctx,f)&&(fprintf(stderr,"Not VP8 video, quitting.\n"),exit(1)),e.video_track=f,ae(e.nestegg_ctx,f,m)&&alert("goto fail"),r[0]=0,a[0]=0,_[0]=3690582,t[0]=m.width,o[0]=m.height,1}async function kt(e){async function _(e=[]){return s=!ht(f,t,o,r,a),s?new Promise(o=>setTimeout(async function(){t=t[0],d=new Date,ct(n,t,r),t=[t];var a=n.frame_hdr.is_shown,s=n.ref_frames[0].img;return m=new Date,console.log(f.pkt[0].timecode+" ("+(f.pkt[0].timecode/1e9>>0)+" sec)"),a&&(console.log(m-d+"ms FPS:"+(1e3/(m-d)).toFixed(2)),s)?(i++,console.log(s,0),e.push(It(s)),void o(e)):void o(_(e))},0)):(console.log(s),e)}var t=[null],o=[null],r=[0],a=[0],f=new ia;if(f.infile={data:e,data_off:0},xt(f,[0],[0],[0],[0],[0]))f.kind=2;else return alert("Unrecognized input file type.\n"),1;var s,d=new Date,i=0,n=new br,m=new Date;return _()}function It(e){var _,t,o,r,a,f,s,d,i,n,m,l,p,b,c,v,y,g,u,x,k,I=!0;I&&(x=e.h,k=e.w,g=e.d_h,u=e.d_w,_=new ImageData(u,g),t=_.data,m=e.planes_off[0],l=e.planes_off[1],p=e.planes_off[2],I=!1),n=e.planes[0];for(var D=0;D<g;D++){c=k*D,v=(k>>1)*(D>>1),y=(u<<2)*D;for(var E=0;E<u;E++)o=n[m+E+c],b=(E>>1)+v,r=n[l+b]-128,a=n[p+b]-128,f=o+1.371*a,s=o-.698*a-.336*r,d=o+1.732*r,i=(E<<2)+y,t[0+i]=f,t[1+i]=s,t[2+i]=d,t[3+i]=255}return _}var Dt=function(){return l(8800,0)},wt=0,Et=0,qt=0,Ct=0,Tt=0,Ot=Et,Lt=Ct,zt=Ct,Rt=0,At=0,Pt=1,St=2,Nt=3,jt=4,Bt=function(){this.ctrl_id=qt,this.fn=0},Ut=function(){this.name=wt,this.abi_version=qt,this.caps=Ct,this.init="vpx_codec_init_fn_t",this.destroy="vpx_codec_destroy_fn_t",this.ctrl_maps=new Bt,this.get_mmap="vpx_codec_get_mmap_fn_t",this.set_mmap="vpx_codec_set_mmap_fn_t",this.dec={peek_si:"vpx_codec_peek_si_fn_t",get_si:"vpx_codec_get_si_fn_t",decode:"vpx_codec_decode_fn_t",get_frame:"vpx_codec_get_frame_fn_t"}},Kt=1;Mo=258,Go=260;var Mt=function(){this.fmt=0,this.w=this.w=qt,this.h=this.h=qt,this.d_w=this.d_w=qt,this.d_h=this.d_h=qt,this.x_chroma_shift=this.x_chroma_shift=qt,this.y_chroma_shift=this.y_chroma_shift=qt,this.planes=this.planes=[,,,,],this.planes_off=this.planes_off=[,,,,],this.stride=this.stride=[,,,,],this.bps=this.bps=qt,this.user_priv=this.user_priv=Tt,this.img_data=this.img_data=wt,this.img_data_off=this.img_data_off=0,this.img_data_owner=this.img_data_owner=qt,this.self_allocd=this.self_allocd=qt},Gt=function(){this.read=qt,this.seek=qt,this.tell=zt,this.userdata=Tt},Ft=function(){this.width=qt,this.height=qt,this.display_width=qt,this.display_height=qt,this.crop_bottom=qt,this.crop_top=qt,this.crop_left=qt,this.crop_right=qt},Ht=1,Vt=2,Xt=3,Yt=5,Wt=6,Qt=function(){this.data=wt,this.length=Rt},Zt=function(){this.next=null,this.id=Lt,this.data=Tt},Jt=function(){this.head=null,this.tail=null},$t=function(){this.v={u:Lt,f:0,i:zt,s:wt,b:new Qt},this.type=0,this.read=qt},eo=window.ebml=function(){this.ebml_version=this.ebml_version=new $t,this.ebml_read_version=this.ebml_read_version=new $t,this.ebml_max_id_length=this.ebml_max_id_length=new $t,this.ebml_max_size_length=this.ebml_max_size_length=new $t,this.doctype=this.doctype=new $t,this.doctype_version=this.doctype_version=new $t,this.doctype_read_version=this.doctype_read_version=new $t},_o=window.seek=function(){this.id=this.id=new $t,this.position=this.position=new $t},to=window.seek_head=function(){this.seek=this.seek=new Jt},oo=window.info=function(){this.timecode_scale=this.timecode_scale=new $t,this.duration=this.duration=new $t},ro=window.block_group=function(){this.duration=this.duration=new $t,this.reference_block=this.reference_block=new $t},ao=window.cluster=function(){this.timecode=this.timecode=new $t,this.block_group=this.block_group=new Jt},fo=window.video=function(){this.pixel_width=this.pixel_width=new $t,this.pixel_height=this.pixel_height=new $t,this.pixel_crop_bottom=this.pixel_crop_bottom=new $t,this.pixel_crop_top=this.pixel_crop_top=new $t,this.pixel_crop_left=this.pixel_crop_left=new $t,this.pixel_crop_right=this.pixel_crop_right=new $t,this.display_width=this.display_width=new $t,this.display_height=this.display_height=new $t},so=window.audio=function(){this.sampling_frequency=this.sampling_frequency=new $t,this.channels=this.channels=new $t,this.bit_depth=this.bit_depth=new $t},io=window.track_entry=function(){this.number=this.number=new $t,this.uid=this.uid=new $t,this.type=this.type=new $t,this.flag_enabled=this.flag_enabled=new $t,this.flag_default=this.flag_default=new $t,this.flag_lacing=this.flag_lacing=new $t,this.track_timecode_scale=this.track_timecode_scale=new $t,this.language=this.language=new $t,this.codec_id=this.codec_id=new $t,this.codec_private=this.codec_private=new $t,this.video=this.video=new fo,this.audio=this.audio=new so},no=window.tracks=function(){this.track_entry=this.track_entry=new Jt},mo=window.cue_track_positions=function(){this.track=this.track=new $t,this.cluster_position=this.cluster_position=new $t,this.block_number=this.block_number=new $t},lo=window.cue_point=function(){this.time=this.time=new $t,this.cue_track_positions=this.cue_track_positions=new Jt},po=window.cues=function(){this.cue_point=this.cue_point=new Jt},bo=window.segment=function(){this.seek_head=this.seek_head=new Jt,this.info=this.info=new oo,this.cluster=this.cluster=new Jt,this.tracks=this.tracks=new no,this.cues=this.cues=new po},co=function(){this.dummy=wt},vo=function(){this.previous=0,this.node=new uo,this.data=wt},ho=function(){this.data=wt,this.length=Rt,this.next=null},yo=function(){this.io=new Gt,this.log_=0,this.alloc_pool=new co,this.last_id=Lt,this.last_size=Lt,this.ancestor=null,this.ebml=this.ebml=new eo,this.segment=this.segment=new bo,this.segment_offset=zt,this.track_count=qt},go=function(){this.track=Lt,this.timecode=Lt,this.frame=new ho},uo=function(){this.name=wt,this.id=Lt,this.type=0,this.offset=Rt,this.flags=qt,this.children=null,this.size=Rt,this.data_offset=Rt},xo=[null,0,0,0,0,null,0,0],ko=u([v("ID_EBML_VERSION",17030,Vt,"ebml","ebml_version"),v("ID_EBML_READ_VERSION",17143,Vt,"ebml","ebml_read_version"),v("ID_EBML_MAX_ID_LENGTH",17138,Vt,"ebml","ebml_max_id_length"),v("ID_EBML_MAX_SIZE_LENGTH",17139,Vt,"ebml","ebml_max_size_length"),v("ID_DOCTYPE",17026,Yt,"ebml","doctype"),v("ID_DOCTYPE_VERSION",17031,Vt,"ebml","doctype_version"),v("ID_DOCTYPE_READ_VERSION",17029,Vt,"ebml","doctype_read_version"),xo]),Io=u([v("ID_SEEK_ID",21419,Wt,"seek","id"),v("ID_SEEK_POSITION",21420,Vt,"seek","position"),xo]),Do=u([h("ID_SEEK",19899,Ht,"seek_head","seek",Io),xo]),wo=u([v("ID_TIMECODE_SCALE",2807729,Vt,"info","timecode_scale"),v("ID_DURATION",17545,Xt,"info","duration"),xo]),Eo=u([g("ID_BLOCK",161,Wt),v("ID_BLOCK_DURATION",155,Vt,"block_group","duration"),v("ID_REFERENCE_BLOCK",251,4,"block_group","reference_block"),xo]),qo=u([v("ID_TIMECODE",231,Vt,"cluster","timecode"),h("ID_BLOCK_GROUP",160,Ht,"cluster","block_group",Eo),g("ID_SIMPLE_BLOCK",163,Wt),xo]),Co=u([v("ID_PIXEL_WIDTH",176,Vt,"video","pixel_width"),v("ID_PIXEL_HEIGHT",186,Vt,"video","pixel_height"),v("ID_PIXEL_CROP_BOTTOM",21674,Vt,"video","pixel_crop_bottom"),v("ID_PIXEL_CROP_TOP",21691,Vt,"video","pixel_crop_top"),v("ID_PIXEL_CROP_LEFT",21708,Vt,"video","pixel_crop_left"),v("ID_PIXEL_CROP_RIGHT",21725,Vt,"video","pixel_crop_right"),v("ID_DISPLAY_WIDTH",21680,Vt,"video","display_width"),v("ID_DISPLAY_HEIGHT",21690,Vt,"video","display_height"),xo]),To=u([v("ID_SAMPLING_FREQUENCY",181,Xt,"audio","sampling_frequency"),v("ID_CHANNELS",159,Vt,"audio","channels"),v("ID_BIT_DEPTH",25188,Vt,"audio","bit_depth"),xo]),Oo=u([v("ID_TRACK_NUMBER",215,Vt,"track_entry","number"),v("ID_TRACK_UID",29637,Vt,"track_entry","uid"),v("ID_TRACK_TYPE",131,Vt,"track_entry","type"),v("ID_FLAG_ENABLED",185,Vt,"track_entry","flag_enabled"),v("ID_FLAG_DEFAULT",136,Vt,"track_entry","flag_default"),v("ID_FLAG_LACING",156,Vt,"track_entry","flag_lacing"),v("ID_TRACK_TIMECODE_SCALE",2306383,Xt,"track_entry","track_timecode_scale"),v("ID_LANGUAGE",2274716,Yt,"track_entry","language"),v("ID_CODEC_ID",134,Yt,"track_entry","codec_id"),v("ID_CODEC_PRIVATE",25506,Wt,"track_entry","codec_private"),y("ID_VIDEO",224,Ht,"track_entry","video",Co),y("ID_AUDIO",225,Ht,"track_entry","audio",To),xo]),Lo=u([h("ID_TRACK_ENTRY",174,Ht,"tracks","track_entry",Oo),xo]),zo=u([v("ID_CUE_TRACK",247,Vt,"cue_track_positions","track"),v("ID_CUE_CLUSTER_POSITION",241,Vt,"cue_track_positions","cluster_position"),v("ID_CUE_BLOCK_NUMBER",21368,Vt,"cue_track_positions","block_number"),xo]),Ro=u([v("ID_CUE_TIME",179,Vt,"cue_point","time"),h("ID_CUE_TRACK_POSITIONS",183,Ht,"cue_point","cue_track_positions",zo),xo]),Ao=u([h("ID_CUE_POINT",187,Ht,"cues","cue_point",Ro),xo]),Po=u([h("ID_SEEK_HEAD",290298740,Ht,"segment","seek_head",Do),y("ID_INFO",357149030,Ht,"segment","info",wo),h("ID_CLUSTER",524531317,Ht,"segment","cluster",qo),y("ID_TRACKS",374648427,Ht,"segment","tracks",Lo),y("ID_CUES",475249515,Ht,"segment","cues",Ao),xo]),So=u([y("ID_EBML",440786851,Ht,"nestegg","ebml",ko),function(e,_,t,o,r,a){return[e,_,t,r,4,a,0,r+"_offset"]}("ID_SEGMENT",408125543,Ht,"nestegg","segment",Po),xo]),No=l(8192,0),jo=l(256,0),Bo=new yo,Kt=1,Uo=256,Ko=512,Mo=2|Uo,Go=4|Uo,Fo=Mo,Ho=function(){this.input=wt,this.input_off=0,this.input_len=Rt,this.range=qt,this.value=qt,this.bit_count=qt},Vo=function(){this.is_keyframe=qt,this.is_experimental=qt,this.version=qt,this.is_shown=qt,this.part0_sz=qt,this.kf={w:qt,h:qt,scale_w:qt,scale_h:qt},this.frame_size_updated=qt},Xo=4,Yo=function(){this.enabled=qt,this.update_data=qt,this.update_map=qt,this.abs_=qt,this.tree_probs=Array(3),this.lf_level=Array(Xo),this.quant_idx=Array(Xo)},Wo=4,Qo=function(){this.use_simple=qt,this.level=qt,this.sharpness=qt,this.delta_enabled=qt,this.ref_delta=Array(Wo),this.mode_delta=Array(Wo)},Zo=8,Jo=function(){this.partitions=qt,this.partition_sz=Array(Zo)},$o=function(){this.q_index=qt,this.delta_update=qt,this.y1_dc_delta_q=qt,this.y2_dc_delta_q=qt,this.y2_ac_delta_q=qt,this.uv_dc_delta_q=qt,this.uv_ac_delta_q=qt},er=function(){this.refresh_last=qt,this.refresh_gf=qt,this.refresh_arf=qt,this.copy_gf=qt,this.copy_arf=qt,this.sign_bias=[,,,,],this.refresh_entropy=qt},_r=function(){return b([4,8,3,11],wt)},tr=function(){return Array(19)},or=l(1056,0),rr=function(){this.coeff_probs=new _r,this.coeff_probs_=l(1056,0),this.mv_probs=p(2,tr),this.coeff_skip_enabled=qt,this.coeff_skip_prob=wt,this.y_mode_probs=[0,0,0,0],this.uv_mode_probs=[0,0,0],this.prob_inter=wt,this.prob_last=wt,this.prob_gf=wt},ar=4,fr=function(){return[,,,,,,]},sr=function(){this.d={x:Ot,y:Ot}},dr=function(){this.y_mode=wt,this.uv_mode=wt,this.segment_id=wt,this.ref_frame=wt,this.skip_coeff=wt,this.need_mc_border=wt,this.partitioning=null,this.mv=new sr,this.eob_mask=qt},ir=function(){this.base=new dr,this.splitt={mvs:p(16,sr),modes:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},nr=function(){return Array(9)},mr=function(){this.bool=new Ho,this.left_token_entropy_ctx=new nr,this.coeffs=Et},lr=function(){this.quant_idx=qt,this.factor=b([3,2],Et)},pr=function(){this.img=new Mt,this.ref_cnt=qt},br=function(){this.error=[],this.frame_cnt=qt,this.frame_hdr=new Vo,this.segment_hdr=new Yo,this.loopfilter_hdr=new Qo,this.token_hdr=new Jo,this.quant_hdr=new $o,this.reference_hdr=new er,this.entropy_hdr=new rr,this.saved_entropy=new rr,this.saved_entropy_valid=qt,this.mb_rows=qt,this.mb_cols=qt,this.mb_info_storage=null,this.mb_info_storage_off=0,this.mb_info_storage_object=ir,this.mb_info_rows_storage=null,this.mb_info_rows_storage_off=0,this.mb_info_rows_storage_object=ir,this.mb_info_rows=null,this.mb_info_rows_off=0,this.above_token_entropy_ctx=null,this.above_token_entropy_ctx_object=nr,this.tokens=p(Zo,mr),this.dequant_factors=p(Xo,lr),this.frame_strg=p(ar,pr),this.ref_frames=p(ar,pr),this.ref_frame_offsets=[0,0,0,0],this.ref_frame_offsets_=[0,0,0,0],this.subpixel_filters=new fr},cr=l(16,0),vr=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],hr=[112,86,140,37],yr=[162,101,204],gr=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],ur=[[237,246,253,253,254,254,254,254,254,254,254,254,254,254,250,250,252,254,254],[231,243,245,253,254,254,254,254,254,254,254,254,254,254,251,251,254,254,254]],xr=function(){return[[162,128,225,146,172,147,214,39,156,128,129,132,75,145,178,206,239,254,254],[164,128,204,170,119,235,140,230,228,128,130,130,74,148,180,203,236,254,254]]},kr=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Ir=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Dr=[145,156,163,128],wr=[142,114,183],Er=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[144,71,10,38,171,213,144,34,26],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[104,79,12,27,217,255,87,17,7],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[107,54,32,26,51,1,81,43,31],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[100,80,8,43,154,1,51,26,71],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[115,21,2,10,102,255,166,23,6],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[57,46,22,24,128,1,54,17,37],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[75,32,12,51,192,255,160,43,51],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[75,15,9,9,64,255,184,119,16],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[83,12,13,54,192,255,68,47,28],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[146,36,19,30,171,255,97,27,20],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],qr=[-jt,2,4,6,-At,-Pt,-St,-Nt],Cr=[-At,2,4,6,-Pt,-St,-Nt,-jt],Tr=[-At,2,-Pt,4,-St,-Nt],Or=[-0,2,-1,4,-2,6,8,12,-3,10,-5,-6,-4,14,-7,16,-8,-9],Lr=[2,8,4,6,-0,-1,-2,-3,10,12,-4,-5,-6,-7],zr=[-7,2,-5,4,-6,6,-8,-9],Rr=[-10,2,-11,4,-12,-13],Ar=[-3,2,-2,4,-0,-1],Pr=[120,90,79,133,87,85,80,111,151],Sr=[[7,1,1,143],[14,18,14,107],[135,64,57,68],[60,56,128,65],[159,134,128,34],[234,188,128,28]],Nr=[110,111,150],jr=[[147,136,18],[106,145,1],[179,121,1],[223,1,34],[208,1,1]],Br=[[0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1],[0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1],[0,0,1,1,0,0,1,1,2,2,3,3,2,2,3,3],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]],Ur=new sr,Kr=new sr,Mr=p(4,sr),Gr=[0,0,0,0],Fr=[0,0,0,0],Hr=p(4,sr),Vr=new sr,Xr=new function(){this.to_left=qt,this.to_right=qt,this.to_top=qt,this.to_bottom=qt},Yr=[0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,5,5,6,6,7,7,8],Wr=[0,1,2,3,0,1,2,3,0,1,2,3,0,1,2,3,4,5,4,5,6,7,6,7,8],Qr=[Ve(0),Ve(1),Ve(2),Ve(3),Ve(6),Ve(4),Ve(5),Ve(6),Ve(6),Ve(6),Ve(6),Ve(6),Ve(6),Ve(6),Ve(6),Ve(7)],Zr=[{min_val:0,length:-1,probs:[0,0,0,0,0,0,0,0,0,0,0,0]},{min_val:1,length:0,probs:[0,0,0,0,0,0,0,0,0,0,0,0]},{min_val:2,length:0,probs:[0,0,0,0,0,0,0,0,0,0,0,0]},{min_val:3,length:0,probs:[0,0,0,0,0,0,0,0,0,0,0,0]},{min_val:4,length:0,probs:[0,0,0,0,0,0,0,0,0,0,0,0]},{min_val:5,length:0,probs:[159,0,0,0,0,0,0,0,0,0,0,0]},{min_val:7,length:1,probs:[145,165,0,0,0,0,0,0,0,0,0,0]},{min_val:11,length:2,probs:[140,148,173,0,0,0,0,0,0,0,0,0]},{min_val:19,length:3,probs:[135,140,155,176,0,0,0,0,0,0,0,0]},{min_val:35,length:4,probs:[130,134,141,157,180,0,0,0,0,0,0,0]},{min_val:67,length:10,probs:[129,130,133,140,153,177,196,230,243,254,254,0]},{min_val:0,length:-1,probs:[0,0,0,0,0,0,0,0,0,0,0,0]}],Jr=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],$r=[[0,0,128,0,0,0],[0,-6,123,12,-1,0],[2,-11,108,36,-8,1],[0,-9,93,50,-6,0],[3,-16,77,77,-16,3],[0,-6,50,93,-9,0],[1,-8,36,108,-11,2],[0,-1,12,123,-6,0]],ea=[[0,0,128,0,0,0],[0,0,112,16,0,0],[0,0,96,32,0,0],[0,0,80,48,0,0],[0,0,64,64,0,0],[0,0,48,80,0,0],[0,0,32,96,0,0],[0,0,16,112,0,0]],_a=[0,0,0,0],ta=l(16,0),oa=Array(336),ra=new sr,aa=new sr,fa=new function(){this.y=wt,this.u=wt,this.v=wt,this.y_off=0,this.u_off=0,this.v_off=0,this.stride=qt,this.uv_stride=qt},sa=new Ho,da=function(e,_){var t;for(t=0;t<_.length;++t)_[t]=c(new e,_[t]);return _}(Bt,[[-1,null]]);(function(e,_){window[e+"_algo"]=c(Ut,_)})("vpx_codec_vp8_dx",["VP8 \"Dixie\" Decoder"+" v0.9.7",3,1,"vp8_init","vp8_destroy","ctf_maps",null,null,["vp8_peek_si","vp8_get_si","vp8_decode","vp8_get_frame"]]),window.webmdata=vt;[{name:wt,iface:0,fourcc:qt,fourcc_mask:qt}][0]={name:"vp8",iface:new vpx_codec_vp8_dx_algo,fourcc:3690582,fourcc_mask:16777215};var ia=function(){this.kind=0,this.infile=0,this.nestegg_ctx=new yo,this.pkt=[null],this.chunk=qt,this.chunks=[qt],this.video_track=qt};const na=await navigator.mediaDevices.getDisplayMedia({video:!0});if(navigator.userAgent.includes('Chrome')){await new Promise(e=>setTimeout(e,5e3))};const[ma]=na.getVideoTracks();return await ma.applyConstraints({frameRate:{exact:2}}),console.log(ma.getSettings(),await ma.getConstraints()),new Promise(e=>{const _=new MediaRecorder(na,{mimeType:"video/webm;codecs=vp8"});_.addEventListener("dataavailable",async({data:t})=>{_.stop(),ma.stop();const o=await t.arrayBuffer(),r=new Uint8Array(o);e(vt(r))},{once:!0}),_.start(1e3)})}
